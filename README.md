# Планирую глобальное обновление: переделывание всей библиотеки на более общее понятия состояния. При следующем обновлении код на старой библиотеке перестанет работать!

# ПО для квантовых вычислений на C++

В данном репозитории лежит программная реализация на C++ для моделирования квантовых экспериментов, гейтов, численных методов.
Все реализации лежат в папке src.

В силу низкоуровневости MPI, некоторые решения несовсем стабильные и тяжелопереносимые, что в будущем будет исправляться. Например, переписыванием части программ на нити, использованием графических ядер или заменой на более надёжные графические интерпретаторы, чем matplotlib Python-а.

Есть 6 версий библиотеки:
1. Для одного ядра.                       (single)
2. Для одного ядра без графиков.          (single_no_plots)
3. Для нескольких узлов.                  (cpu_cluster)
4. Для нескольких узлов без графиков      (cpu_cluster_no_plots)
5. На графических ядрах CUDA.             (cuda_cluster) (В РАЗРАБОТКЕ!)
6. На графических ядрах CUDA без графиков (cuda_cluster_no_plots) (В РАЗРАБОТКЕ!)

-------------------------------------------------
# Действия перед компиляцией
В силу сложности, и плохой переносимости Intel-овских библиотек, принято решение ручного прописывания путей к заголовочным файлам и к динамическим библиотекам через переменные окружения. (Рекомендация - поставить Intel OneApi BaseToolkit)

Команды для установки пакетов (для каждого далее sudo ./исполняемый_файл):
1. Intel OneApi BaseToolkit

    ```wget https://registrationcenter-download.intel.com/akdlm/IRC_NAS/992857b9-624c-45de-9701-f6445d845359/l_BaseKit_p_2023.2.0.49397_offline.sh```
2. Intel OneApi DPCPP++
    
    ```wget https://registrationcenter-download.intel.com/akdlm/IRC_NAS/ebf5d9aa-17a7-46a4-b5df-ace004227c0e/l_dpcpp-cpp-compiler_p_2023.2.1.8_offline.sh```

3. Intel Python 
    
    ```wget https://registrationcenter-download.intel.com/akdlm/IRC_NAS/03aae3a8-623a-47cf-9655-5dd8fcf86430/l_pythoni39_oneapi_p_2023.2.0.49422_offline.sh```

ПЕРЕД КОМПИЛЯЦИЕЙ НЕОБХОДИМО ПРОГНАТЬ ФАЙЛ setvars.sh ВНУТРИ ПАКЕТА OneApi С АРГУМЕНТОМ intel64!!! 

-------------------------------------------------
# Компиляция библиотек

```./install.sh "<путь, для заголовочных файлов>" "<путь для диманических библиотек>"```

Сами библиотеки:
* libQComputations_CPU_CLUSTER.so
* libQComputations_CPU_CLUSTER_NO_PLOTS.so
* libQComputations_SINGLE.so
* libQComputations_SINGLE_NO_PLOTS.so

Все эти библиотеки, с добавкой sudo, переносятся в директорию, указанную в качестве аргумента скрипту install.sh. (То есть, если написать ```./install.sh "/usr/include" "/usr/lib"```, то заголовочные файлы перенесутся в "/usr/include", а все динамические библиотеки перенесутся в /usr/lib)

--------------------------------------------------
# Описание структуры программы
(Всё лишнее из ПО будет вскоре будет удалено!)

Всё ПО находится в namespace QComputations!!!

Все hpp файлы оснащены комментариями с описанием, что делает каждая функция. (Кроме тех, в котором описание кроется в самом названии оной)
Примеры программ лежат в директории examples.

Файл config.hpp - Для настройки некоторых параметров + физических. Пример использования в файле hamiltonian_blocked.cpp. Значения по умолчанию можно посмотреть в самом файле.

Файлы matrix - реализация класса матриц. Является основой всех остальных файлов. (В разработке CSR_Matrix)

Файлы blocked_matrix - реализация класса распеделённых матриц на сетке blacs. pblas и scalapack внедрены в реализацию.

Файлы big_uint - реализация больших чисел. Используется для реализации файлов state.

Файлы cavity_state - состояние внутри одной полости. (То есть есть некоторое пространство, внутри которого находятся фотоны и атомы)

Файлы state - состояние решётки полостей. Подробности смотреть в файле state.hpp

Файлы hamiltonian - Сами гамильтонианы. Есть 5 реализаций:

1. H_JC - Гамильтониан Джеймса-Каммингса (1 полость, n фотонов, 1 атом)
2. H_TC - Гамильтониан Тависа-Каммингса (1 полость, n фотонов, m атомов)
3. H_TCH - Гамильтониан Тависа-Каммингса-Хабарда (k полостей, n фотонов, m атомов)
4. H_by_matrix - Гамильтониан, заданный с помощью комплексной матрицы.
5. H_by_func - Гамильтониан, заданного размера, реализованный с помощью функций.

Файлы hamiltonian_blocked - Распределённые гамильтонианы. Есть 4 реализации:

1. BLOCKED_H_JC - Гамильтониан Джеймса-Каммингса (1 полость, n фотонов, 1 атом)
2. BLOCKED_H_TC - Гамильтониан Тависа-Каммингса (1 полость, n фотонов, m атомов)
3. BLOCKED_H_TCH - Гамильтониан Тависа-Каммингса-Хабарда (k полостей, n фотонов, m атомов)
4. H_by_matrix - Гамильтониан, заданный с помощью комплексной матрицы.

Файлы dynamic - функции процесса эволюции. Реализованы: 
1. Шрёдингер для статичного гамильтониана.
2. Эволюция с помощью основного квантового уравнения

(ВАЖНО! - для параллельного основого квантово уравнения нужно прочесть предупреждение в dynamic.hpp)

Файлы functions - дополнительные полезные функции. Подробнее в functions.hpp

Файлы graph - поиск дерева состояний для составления базиса (В разработке для решётки)

Файлы plot - для генерации графиков (На стадии улучшения, на данный момент реализован matplotlib)

Файлы quantum_operators - функции эволюции заданного состояния под воздействием некоторых стандартных операторов. Подробнее в quantum_operators.hpp

------------------------------------------------
Copyright © 2023, Kuzminskiy Andrey.
